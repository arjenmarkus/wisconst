# plot_var.tcl --
#     Plot the variance as function of the number of variates
#
lappend auto_path d:/tcl-programs/pdf4tcl-head
package require pdf4tcl
package require Plotchart

pack [canvas .c -width 600 -height 400]

set p [::Plotchart::createXYPlot .c {0 100 20} {0 0.1 0.02}]

$p dataconfig estimate -colour red

foreach {number sum_r sum_square var} {
    1  0.5006E+05  0.3341E+05  0.8344E-01
    2  0.1002E+06  0.1172E+06  0.4182E-01
    3  0.1502E+06  0.2508E+06  0.2794E-01
    4  0.2001E+06  0.4342E+06  0.2105E-01
    5  0.2502E+06  0.6680E+06  0.1687E-01
    6  0.3002E+06  0.9515E+06  0.1402E-01
    7  0.3501E+06  0.1285E+07  0.1201E-01
    8  0.4003E+06  0.1670E+07  0.1051E-01
    9  0.4503E+06  0.2104E+07  0.9338E-02
   10  0.5003E+06  0.2587E+07  0.8388E-02
   11  0.5503E+06  0.3120E+07  0.7639E-02
   12  0.6001E+06  0.3702E+07  0.6990E-02
   13  0.6501E+06  0.4335E+07  0.6443E-02
   14  0.7001E+06  0.5019E+07  0.5993E-02
   15  0.7503E+06  0.5755E+07  0.5571E-02
   16  0.8002E+06  0.6538E+07  0.5231E-02
   17  0.8503E+06  0.7372E+07  0.4921E-02
   18  0.9003E+06  0.8255E+07  0.4648E-02
   19  0.9503E+06  0.9188E+07  0.4389E-02
   20  0.1000E+07  0.1017E+08  0.4170E-02
   21  0.1050E+07  0.1120E+08  0.3976E-02
   22  0.1100E+07  0.1229E+08  0.3791E-02
   23  0.1150E+07  0.1342E+08  0.3611E-02
   24  0.1200E+07  0.1460E+08  0.3461E-02
   25  0.1250E+07  0.1584E+08  0.3328E-02
   26  0.1300E+07  0.1712E+08  0.3202E-02
   27  0.1350E+07  0.1845E+08  0.3085E-02
   28  0.1400E+07  0.1983E+08  0.2973E-02
   29  0.1450E+07  0.2127E+08  0.2867E-02
   30  0.1500E+07  0.2275E+08  0.2764E-02
   31  0.1550E+07  0.2428E+08  0.2674E-02
   32  0.1600E+07  0.2586E+08  0.2590E-02
   33  0.1650E+07  0.2750E+08  0.2516E-02
   34  0.1700E+07  0.2918E+08  0.2451E-02
   35  0.1750E+07  0.3092E+08  0.2378E-02
   36  0.1800E+07  0.3270E+08  0.2309E-02
   37  0.1850E+07  0.3453E+08  0.2247E-02
   38  0.1900E+07  0.3642E+08  0.2197E-02
   39  0.1950E+07  0.3835E+08  0.2140E-02
   40  0.2000E+07  0.4033E+08  0.2085E-02
   41  0.2050E+07  0.4236E+08  0.2037E-02
   42  0.2100E+07  0.4445E+08  0.1992E-02
   43  0.2150E+07  0.4658E+08  0.1945E-02
   44  0.2200E+07  0.4876E+08  0.1906E-02
   45  0.2250E+07  0.5099E+08  0.1865E-02
   46  0.2300E+07  0.5327E+08  0.1824E-02
   47  0.2350E+07  0.5560E+08  0.1782E-02
   48  0.2400E+07  0.5800E+08  0.1744E-02
   49  0.2450E+07  0.6043E+08  0.1704E-02
   50  0.2500E+07  0.6292E+08  0.1672E-02
   51  0.2550E+07  0.6545E+08  0.1638E-02
   52  0.2600E+07  0.6803E+08  0.1607E-02
   53  0.2650E+07  0.7066E+08  0.1576E-02
   54  0.2700E+07  0.7334E+08  0.1543E-02
   55  0.2750E+07  0.7608E+08  0.1521E-02
   56  0.2800E+07  0.7887E+08  0.1494E-02
   57  0.2850E+07  0.8170E+08  0.1470E-02
   58  0.2900E+07  0.8458E+08  0.1446E-02
   59  0.2950E+07  0.8751E+08  0.1417E-02
   60  0.3000E+07  0.9050E+08  0.1388E-02
   61  0.3050E+07  0.9353E+08  0.1372E-02
   62  0.3100E+07  0.9662E+08  0.1350E-02
   63  0.3150E+07  0.9974E+08  0.1323E-02
   64  0.3200E+07  0.1029E+09  0.1299E-02
   65  0.3250E+07  0.1062E+09  0.1286E-02
   66  0.3300E+07  0.1095E+09  0.1269E-02
   67  0.3350E+07  0.1128E+09  0.1247E-02
   68  0.3400E+07  0.1162E+09  0.1230E-02
   69  0.3450E+07  0.1196E+09  0.1211E-02
   70  0.3500E+07  0.1231E+09  0.1196E-02
   71  0.3550E+07  0.1266E+09  0.1176E-02
   72  0.3600E+07  0.1302E+09  0.1160E-02
   73  0.3650E+07  0.1338E+09  0.1143E-02
   74  0.3700E+07  0.1375E+09  0.1130E-02
   75  0.3750E+07  0.1413E+09  0.1110E-02
   76  0.3800E+07  0.1451E+09  0.1099E-02
   77  0.3850E+07  0.1489E+09  0.1083E-02
   78  0.3900E+07  0.1528E+09  0.1066E-02
   79  0.3950E+07  0.1567E+09  0.1053E-02
   80  0.4000E+07  0.1607E+09  0.1038E-02
   81  0.4050E+07  0.1647E+09  0.1028E-02
   82  0.4100E+07  0.1688E+09  0.1023E-02
   83  0.4150E+07  0.1729E+09  0.1005E-02
   84  0.4200E+07  0.1771E+09  0.9961E-03
   85  0.4250E+07  0.1814E+09  0.9824E-03
   86  0.4300E+07  0.1856E+09  0.9704E-03
   87  0.4350E+07  0.1900E+09  0.9583E-03
   88  0.4400E+07  0.1944E+09  0.9418E-03
   89  0.4450E+07  0.1988E+09  0.9382E-03
   90  0.4501E+07  0.2033E+09  0.9243E-03
   91  0.4550E+07  0.2078E+09  0.9179E-03
   92  0.4600E+07  0.2124E+09  0.9025E-03
   93  0.4650E+07  0.2170E+09  0.8958E-03
   94  0.4701E+07  0.2217E+09  0.8839E-03
   95  0.4750E+07  0.2265E+09  0.8792E-03
   96  0.4800E+07  0.2312E+09  0.8708E-03
   97  0.4850E+07  0.2361E+09  0.8598E-03
   98  0.4900E+07  0.2410E+09  0.8466E-03
   99  0.4950E+07  0.2459E+09  0.8415E-03
  100  0.5001E+07  0.2509E+09  0.8311E-03
} {
     set estimate [expr {0.083 / $number}]

     $p plot data $number $var
     $p plot estimate $number $estimate
}

after 1000 {
    set pdf1 [::pdf4tcl::new %AUTO% -paper {6.2c 4.2c}]
    $pdf1 canvas .c -width 6.2c
    $pdf1 write -file uniform_variance.pdf
}
